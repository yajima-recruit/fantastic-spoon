<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <title>参加者表示</title>
    <link rel="stylesheet" href="./waitngList_view.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <div id="container"></div>
    <script src="./waitngList_view.js"></script>
    <script>
        let ws;
        const url = "ws://localhost:8000/ws?key=C";

        function connect() {
            ws = new WebSocket(url);

            ws.onopen = () => {
                console.log("接続成功（C）");
            };

            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);

                // リストを表示
                WaitingListView(data.queue)
            };

            ws.onclose = () => {
                console.log("接続が閉じられました。1秒後に再接続します...");
                setTimeout(connect, 1000);
            };

            ws.onerror = (error) => {
                console.error("WebSocket エラー:", error);
                ws.close();
            };
        }

        // 初回接続
        connect();
    </script>
</body>